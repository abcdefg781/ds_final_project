---
title: "Time Distribution"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(viridis)
library(lubridate)
```


```{r include = FALSE}
taxi_data = read_csv("./data/transport_final.csv")
```

# Manhattan
## Tidy Data
```{r echo = FALSE, message = FALSE}
manhattan_data = 
  taxi_data %>% 
  filter(pu_boro == "Manhattan") %>% 
  select(pickup_date, pickup_time, dropoff_date, dropoff_time) %>% 
  separate(pickup_time, into = c("pickup_hr", "pickup_min", "pickup_sec"), sep = ":") %>% 
  separate(dropoff_time, into = c("dropoff_hr", "dropoff_min", "dropoff_sec"), sep = ":") %>% 
  select(-pickup_sec, -dropoff_sec) %>% 
  mutate(
    pickup_hr = as.numeric(pickup_hr),
    pickup_min = as.numeric(pickup_min),
    dropoff_hr = as.numeric(dropoff_hr),
    dropoff_min = as.numeric(dropoff_min)
  )
```

## Plot Data
```{r echo = FALSE, message = FALSE}
manhattan_data %>% 
  group_by(pickup_date) %>% 
  ggplot(aes(x = pickup_hr)) +
  geom_histogram(bins = 24) +
  labs(
    title = "Time Distribution of Pickups in Manhattan on Feb 14",
    x = "Pickup Hour",
    y = "Count"
  )
```

## Plot just Dinner Data
```{r}
manhattan_data %>% 
  filter((pickup_date == "2019-02-14" & pickup_hr == 6:9)) %>% 
  ggplot(aes(x = pickup_hr)) +
  geom_histogram(bins = 4) +
  labs(
    title = "Time Distribution of Dinner Pickups in Manhattan",
    x = "Pickup Hour",
    y = "Count"
  )
```

# Brooklyn
## Tidy Data
```{r echo = FALSE, message = FALSE}
brooklyn_data =
  taxi_data %>% 
  filter(pu_boro == "Brooklyn") %>% 
  select(pickup_date, pickup_time, dropoff_date, dropoff_time) %>% 
  separate(pickup_time, into = c("pickup_hr", "pickup_min", "pickup_sec"), sep = ":") %>% 
  separate(dropoff_time, into = c("dropoff_hr", "dropoff_min", "dropoff_sec"), sep = ":") %>% 
  select(-pickup_sec, -dropoff_sec) %>% 
  mutate(
    pickup_hr = as.numeric(pickup_hr),
    pickup_min = as.numeric(pickup_min),
    dropoff_hr = as.numeric(dropoff_hr),
    dropoff_min = as.numeric(dropoff_min)
  )
```

## Plot Data
```{r echo = FALSE, message = FALSE}
brooklyn_data %>% 
  group_by(pickup_date) %>% 
  ggplot(aes(x = pickup_hr)) +
  geom_histogram(bins = 24) +
  labs(
    title = "Time Distribution of Pickups in Brooklyn on Feb 14",
    x = "Pickup Hour",
    y = "Count"
  )
```

## Plot just Dinner Data
```{r}
brooklyn_data %>% 
  filter((pickup_date == "2019-02-14" & pickup_hr == 6:9)) %>% 
  ggplot(aes(x = pickup_hr)) +
  geom_histogram(bins = 4) +
  labs(
    title = "Time Distribution of Dinner Pickups in Brooklyn",
    x = "Pickup Hour",
    y = "Count"
  )
```

